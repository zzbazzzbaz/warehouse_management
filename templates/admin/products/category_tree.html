{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}商品分类树{% endblock %}

{% block content %}
<style>
    .category-tree {
        padding: 20px;
        background: #fff;
        border-radius: 4px;
    }
    .category-tree ul {
        list-style: none;
        padding-left: 20px;
        margin: 0;
    }
    .category-tree > ul {
        padding-left: 0;
    }
    .category-tree li {
        padding: 8px 0;
        border-left: 2px solid #e0e0e0;
        margin-left: 10px;
        padding-left: 15px;
        position: relative;
    }
    .category-tree li::before {
        content: '';
        position: absolute;
        top: 18px;
        left: -2px;
        width: 15px;
        height: 2px;
        background: #e0e0e0;
    }
    .category-tree > ul > li {
        border-left: none;
        margin-left: 0;
        padding-left: 0;
    }
    .category-tree > ul > li::before {
        display: none;
    }
    .category-item {
        display: inline-flex;
        align-items: center;
        padding: 8px 15px;
        background: #f5f5f5;
        border-radius: 4px;
        transition: all 0.2s;
    }
    .category-item:hover {
        background: #e3f2fd;
    }
    .category-item.inactive {
        opacity: 0.5;
    }
    .category-icon {
        margin-right: 8px;
        color: #1976d2;
    }
    .category-name {
        font-weight: 500;
        color: #333;
    }
    .category-badge {
        margin-left: 10px;
        padding: 2px 8px;
        border-radius: 10px;
        font-size: 12px;
        background: #e0e0e0;
        color: #666;
    }
    .category-badge.products {
        background: #c8e6c9;
        color: #2e7d32;
    }
    .tree-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 1px solid #e0e0e0;
    }
    .tree-title {
        font-size: 18px;
        font-weight: 500;
        color: #333;
    }
    .tree-stats {
        color: #666;
        font-size: 14px;
    }
</style>

<div class="category-tree">
    <div class="tree-header">
        <span class="tree-title"><i class="fas fa-sitemap"></i> 商品分类结构</span>
        <span class="tree-stats">共 {{ total_categories }} 个分类，{{ total_products }} 个商品</span>
    </div>
    
    <ul>
        {% for category in categories %}
        <li>
            <span class="category-item {% if not category.is_active %}inactive{% endif %}">
                <i class="fas fa-folder category-icon"></i>
                <span class="category-name">{{ category.name }}</span>
                {% if category.product_count > 0 %}
                <span class="category-badge products">{{ category.product_count }} 个商品</span>
                {% endif %}
                {% if not category.is_active %}
                <span class="category-badge">已禁用</span>
                {% endif %}
            </span>
            {% if category.children_list %}
            <ul>
                {% for child in category.children_list %}
                <li>
                    <span class="category-item {% if not child.is_active %}inactive{% endif %}">
                        <i class="fas fa-tag category-icon" style="color: #ff9800;"></i>
                        <span class="category-name">{{ child.name }}</span>
                        {% if child.product_count > 0 %}
                        <span class="category-badge products">{{ child.product_count }} 个商品</span>
                        {% endif %}
                        {% if not child.is_active %}
                        <span class="category-badge">已禁用</span>
                        {% endif %}
                    </span>
                </li>
                {% endfor %}
            </ul>
            {% endif %}
        </li>
        {% empty %}
        <li style="color: #999; padding: 20px;">暂无分类数据</li>
        {% endfor %}
    </ul>
</div>
{% endblock %}
